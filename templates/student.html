<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Dashboard — Performance Analytics</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --bg: #0f172a;
      --card-bg: #1e293b;
      --text-light: #e2e8f0;
      --muted: #94a3b8;
      --accent1: #6366f1;
      --accent2: #ec4899;
      --accent3: #10b981;
      --accent4: #f59e0b;
      --danger: #ef4444;
      --warning: #f59e0b;
      font-family: 'Poppins', sans-serif;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text-light);
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      width: 240px;
      background: #111827;
      display: flex;
      flex-direction: column;
      padding: 20px 10px;
    }
    .sidebar h2 {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 20px;
      text-align: center;
      color: #fff;
    }
    .term-nav a {
      display: block;
      padding: 12px 16px;
      margin: 8px 0;
      border-radius: 8px;
      text-decoration: none;
      color: var(--muted);
      transition: 0.2s;
      cursor: pointer;
    }
    .term-nav a.active, .term-nav a:hover {
      background: var(--accent1);
      color: #fff;
    }

    /* Main */
    .main {
      flex: 1;
      padding: 20px 28px;
      display: flex;
      flex-direction: column;
    }

    .top-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 20px;
      cursor: pointer;
      transition: 0.3s;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .card:hover { transform: translateY(-4px); }
    .card h3 { margin: 0; font-size: 16px; }
    .card .value { font-size: 26px; font-weight: 700; }
    .card .desc { font-size: 13px; color: var(--muted); }

    .card:nth-child(1) { background: linear-gradient(135deg, #6366f1, #3b82f6); }
    .card:nth-child(2) { background: linear-gradient(135deg, #ec4899, #db2777); }
    .card:nth-child(3) { background: linear-gradient(135deg, #10b981, #059669); }
    .card:nth-child(4) { background: linear-gradient(135deg, #f59e0b, #d97706); }

    /* Chart container */
    .chart-box {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .chart-container {
      position: relative;
      height: 300px;
      margin-bottom: 20px;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }
    header input {
      padding: 10px 12px;
      background: #1e293b;
      border: none;
      border-radius: 8px;
      color: var(--text-light);
      width: 260px;
      outline: none;
    }

    /* Flash messages */
    .flash-messages {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      max-width: 400px;
    }
    .flash-message {
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .flash-message.success {
      background: var(--accent3);
      color: #021;
    }
    .flash-message.error {
      background: var(--danger);
      color: white;
    }
    .flash-message.info {
      background: var(--accent1);
      color: white;
    }

    /* Recommendations section */
    .recommendations {
      margin-top: 20px;
    }
    .recommendation-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      border-left: 4px solid var(--accent3);
    }
    .recommendation-card.warning {
      border-left-color: var(--warning);
    }
    .recommendation-card.danger {
      border-left-color: var(--danger);
    }
    .recommendation-card h4 {
      margin: 0 0 8px 0;
      color: var(--accent3);
    }
    .recommendation-card.warning h4 {
      color: var(--warning);
    }
    .recommendation-card.danger h4 {
      color: var(--danger);
    }
    .recommendation-card p {
      margin: 0;
      font-size: 14px;
      color: var(--muted);
    }

    /* Logout button */
    .logout-btn {
      background: transparent;
      border: 1px solid var(--muted);
      color: var(--muted);
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.2s;
    }
    .logout-btn:hover {
      border-color: var(--danger);
      color: var(--danger);
    }

    /* Performance factors */
    .factors-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .factor-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 20px;
    }
    .factor-card h4 {
      margin: 0 0 12px 0;
      color: var(--accent1);
      font-size: 14px;
    }
    .factor-value {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .factor-desc {
      font-size: 12px;
      color: var(--muted);
    }

    /* Analytics charts */
    .analytics-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }
    .analytics-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 20px;
      height: 300px;
      margin-bottom: 20px;
    }
    .analytics-card h4 {
      margin: 0 0 12px 0;
      color: var(--accent1);
    }

    /* Comparison section */
    .comparison-section {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 20px;
      margin-top: 20px;
    }
    .comparison-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }
    .comparison-item {
      text-align: center;
      padding: 16px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
    }
    .comparison-value {
      font-size: 20px;
      font-weight: 700;
      margin: 8px 0;
    }
    .comparison-label {
      font-size: 12px;
      color: var(--muted);
    }

    /* Hidden sections */
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <!-- Flash Messages -->
  <div class="flash-messages">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="flash-message {{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>

  <aside class="sidebar">
    <h2>Student Portal</h2>
    <div class="term-nav">
      <a href="#" class="active" data-section="overview">Performance Overview</a>
      <a href="#" data-section="day">Performance by Day</a>
      <a href="#" data-section="teacher">Performance by Teacher</a>
      <a href="#" data-section="topic">Performance by Topic</a>
      <a href="#" data-section="subject">Subject Comparison</a>
      <a href="#" data-section="comparison">Comparison</a>
    </div>
    <div style="margin-top: auto; padding: 16px;">
      <button class="logout-btn" onclick="window.location.href='{{ url_for('logout') }}'">Logout</button>
    </div>
  </aside>

  <main class="main">
    <header>
      <div>
        <h1>Welcome, {{ student.full_name.split(' ')[0] }}</h1>
        <div style="font-size:14px;color:var(--muted)">Student ID: {{ student.student_id }} • {{ student.grade_level }}</div>
      </div>
      <div style="display:flex;gap:12px;align-items:center">
        <input type="text" placeholder="Search topics, grades..." id="searchInput" />
        <div class="export-options">
          <button class="export-btn" data-report="student_progress">Progress Report</button>
          <button class="export-btn" data-report="performance_summary">Grade Summary</button>
        </div>
      </div>
    </header>

    <!-- OVERVIEW SECTION -->
    <section id="overview-section" class="dashboard-section">
      <section class="top-cards">
        <div class="card">
          <h3>Overall Average</h3>
          <div class="value" id="overallAverage">0%</div>
          <div class="desc" id="overallTrend">Loading...</div>
        </div>
      
      </section>

      <section class="chart-box">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
          <h2>Your Performance Overview</h2>
          <div class="export-options">
            <button class="export-btn" id="refreshData">Refresh Data</button>
            <button class="export-btn" id="exportChartData">Export Chart Data</button>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="performanceChart"></canvas>
        </div>
      </section>

      <section class="recommendations">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
          <h3>Personalized Learning Recommendations</h3>
          <button class="export-btn" id="refreshRecommendations">Refresh Recommendations</button>
        </div>
        <div id="recommendations-container">
          <div class="recommendation-card">
            <h4>LOADING RECOMMENDATIONS</h4>
            <p>Analyzing your performance data to provide personalized suggestions...</p>
          </div>
        </div>
      </section>
    </section>

    <!-- PERFORMANCE BY DAY SECTION -->
    <section id="day-section" class="dashboard-section hidden">
      <section class="chart-box">
        <h2>Performance by Day</h2>
        <div class="chart-container">
          <canvas id="dayChart"></canvas>
        </div>
        <div class="data-summary" id="daySummary">
          <strong>Analysis:</strong> Loading day performance analysis...
        </div>
      </section>
    </section>

    <!-- PERFORMANCE BY TEACHER SECTION -->
    <section id="teacher-section" class="dashboard-section hidden">
      <section class="chart-box">
        <h2>Performance by Teacher</h2>
        <div class="chart-container">
          <canvas id="teacherChart"></canvas>
        </div>
        <div class="data-summary" id="teacherSummary">
          <strong>Analysis:</strong> Loading teacher performance analysis...
        </div>
      </section>
    </section>

    <!-- PERFORMANCE BY TOPIC SECTION -->
    <section id="topic-section" class="dashboard-section hidden">
      <section class="chart-box">
        <h2>Performance by Topic</h2>
        <div class="chart-container">
          <canvas id="topicChart"></canvas>
        </div>
        <div class="data-summary" id="topicSummary">
          <strong>Analysis:</strong> Loading topic performance analysis...
        </div>
      </section>
    </section>

    <!-- SUBJECT COMPARISON SECTION -->
    <section id="subject-section" class="dashboard-section hidden">
      <section class="chart-box">
        <h2>Subject Comparison</h2>
        <div class="chart-container">
          <canvas id="subjectChart"></canvas>
        </div>
        <div class="data-summary" id="subjectSummary">
          <strong>Analysis:</strong> Loading subject comparison analysis...
        </div>
      </section>
    </section>

    <!-- COMPARISON SECTION -->
    <section id="comparison-section" class="dashboard-section hidden">
      <section class="comparison-section">
        <h2>Performance Comparison</h2>
        <div class="comparison-grid">
          <div class="comparison-item">
            <h4>Best Performing Day</h4>
            <div class="comparison-value" id="bestDayValue">Loading...</div>
            <div class="comparison-label">Your most productive day for learning</div>
          </div>
          <div class="comparison-item">
            <h4>Most Effective Teacher</h4>
            <div class="comparison-value" id="bestTeacherValue">Loading...</div>
            <div class="comparison-label">Teacher with best results for you</div>
          </div>
          <div class="comparison-item">
            <h4>Strongest Topic</h4>
            <div class="comparison-value" id="bestTopicValue">Loading...</div>
            <div class="comparison-label">Your best performing subject area</div>
          </div>
          <div class="comparison-item">
            <h4>Improvement Area</h4>
            <div class="comparison-value" id="weakTopicValue">Loading...</div>
            <div class="comparison-label">Topic needing more attention</div>
          </div>
        </div>
      </section>
    </section>
  </main>

<script>
    let studentCharts = {};
    let currentPerformanceData = null;

    document.addEventListener('DOMContentLoaded', function() {
        console.log('Student dashboard loading...');
        initializeStudentDashboard();
        setupNavigation();
        
        // Auto-hide flash messages
        setTimeout(hideFlashMessages, 5000);
    });

    function setupNavigation() {
        const navLinks = document.querySelectorAll('.term-nav a');
        const sections = document.querySelectorAll('.dashboard-section');
        
        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active class from all links
                navLinks.forEach(l => l.classList.remove('active'));
                // Add active class to clicked link
                this.classList.add('active');
                
                // Hide all sections
                sections.forEach(section => section.classList.add('hidden'));
                
                // Show selected section
                const sectionId = this.getAttribute('data-section') + '-section';
                document.getElementById(sectionId).classList.remove('hidden');
                
                // Initialize chart for the section if needed
                initializeSectionChart(this.getAttribute('data-section'));
            });
        });

        // Setup export buttons
        document.querySelectorAll('.export-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const reportType = this.getAttribute('data-report');
                exportReport(reportType);
            });
        });

        document.getElementById('refreshData').addEventListener('click', loadStudentData);
        document.getElementById('refreshRecommendations').addEventListener('click', loadRecommendations);
    }

    function initializeSectionChart(section) {
        if (!currentPerformanceData) return;
        
        switch(section) {
            case 'day':
                createDayChart(currentPerformanceData.day_averages);
                break;
            case 'teacher':
                createTeacherChart(currentPerformanceData.teacher_averages);
                break;
            case 'topic':
                createTopicChart(currentPerformanceData.topic_averages);
                break;
            case 'subject':
                createSubjectChart(currentPerformanceData.subject_averages);
                break;
            case 'overview':
                createMainPerformanceChart(currentPerformanceData);
                break;
            case 'comparison':
                updateComparisonData(currentPerformanceData);
                break;
        }
    }

    function initializeStudentDashboard() {
        loadStudentData();
        loadRecommendations();
    }

    function loadStudentData() {
        fetch('/api/performance-data')
            .then(response => response.json())
            .then(data => {
                console.log('Student performance data loaded:', data);
                currentPerformanceData = data;
                
                // Update all charts with real data
                createMainPerformanceChart(data);
                createDayChart(data.day_averages);
                createTeacherChart(data.teacher_averages);
                createTopicChart(data.topic_averages);
                createSubjectChart(data.subject_averages);
                updateComparisonData(data);
                updateKPIs(data);
            })
            .catch(error => {
                console.error('Error loading student data:', error);
            });
    }

    function loadRecommendations() {
        fetch('/api/performance-insights')
            .then(response => response.json())
            .then(recommendations => {
                updateRecommendations(recommendations);
            })
            .catch(error => {
                console.error('Error loading recommendations:', error);
            });
    }

    function createMainPerformanceChart(data) {
        const ctx = document.getElementById('performanceChart');
        if (!ctx) return;

        if (studentCharts.performanceChart) studentCharts.performanceChart.destroy();
        
        studentCharts.performanceChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: data.dates || ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'Your Performance',
                    data: data.scores || [75, 78, 82, 80, 85, 82],
                    tension: 0.4,
                    borderWidth: 2,
                    fill: true,
                    backgroundColor: 'rgba(99,102,241,0.1)',
                    borderColor: 'rgba(99,102,241,0.8)',
                    pointBackgroundColor: 'rgba(99,102,241,1)',
                    pointBorderColor: '#fff'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    x: { 
                        grid: { color: '#1e293b' },
                        ticks: { color: '#94a3b8' }
                    },
                    y: {
                        grid: { color: '#1e293b' },
                        ticks: { color: '#94a3b8' },
                        min: 0,
                        max: 100
                    }
                }
            }
        });
    }

    function createDayChart(dayData) {
        const ctx = document.getElementById('dayChart');
        if (!ctx) return;

        const data = dayData || { Monday: 75, Tuesday: 82, Wednesday: 88, Thursday: 80, Friday: 76 };
        const labels = Object.keys(data);
        const values = Object.values(data);

        if (studentCharts.dayChart) studentCharts.dayChart.destroy();
        
        studentCharts.dayChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Average Score',
                    data: values,
                    backgroundColor: 'rgba(99,102,241,0.8)',
                    borderRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } }
            }
        });

        // Update day summary
        if (labels.length > 0) {
            const bestDay = labels[values.indexOf(Math.max(...values))];
            const worstDay = labels[values.indexOf(Math.min(...values))];
            document.getElementById('daySummary').innerHTML = 
                `<strong>Analysis:</strong> Your performance peaks on ${bestDay} with an average score of ${Math.max(...values)}%. 
                ${worstDay} shows the lowest performance at ${Math.min(...values)}%. Consider distributing study load more evenly.`;
        }
    }

    function createTeacherChart(teacherData) {
        const ctx = document.getElementById('teacherChart');
        if (!ctx) return;

        const data = teacherData || { 'Mr. Kamau': 87, 'Mrs. Moraa': 76, 'Mr. Njoroge': 81 };
        const labels = Object.keys(data);
        const values = Object.values(data);

        if (studentCharts.teacherChart) studentCharts.teacherChart.destroy();
        
        studentCharts.teacherChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Average Score',
                    data: values,
                    backgroundColor: 'rgba(236,72,153,0.8)',
                    borderRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } }
            }
        });

        // Update teacher summary
        if (labels.length > 0) {
            const bestTeacher = labels[values.indexOf(Math.max(...values))];
            const worstTeacher = labels[values.indexOf(Math.min(...values))];
            document.getElementById('teacherSummary').innerHTML = 
                `<strong>Analysis:</strong> ${bestTeacher}'s teaching style appears most effective for you with ${Math.max(...values)}% average. 
                ${worstTeacher}'s classes show room for improvement at ${Math.min(...values)}%.`;
        }
    }

    function createTopicChart(topicData) {
        const ctx = document.getElementById('topicChart');
        if (!ctx) return;

        const data = topicData || { Composition: 92, 'Reading Comprehension': 85, Algebra: 78, Geometry: 75, Grammar: 68 };
        const labels = Object.keys(data);
        const values = Object.values(data);

        if (studentCharts.topicChart) studentCharts.topicChart.destroy();
        
        studentCharts.topicChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Average Score',
                    data: values,
                    backgroundColor: 'rgba(16,185,129,0.8)',
                    borderRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                indexAxis: 'y'
            }
        });

        // Update topic summary
        if (labels.length > 0) {
            const bestTopic = labels[values.indexOf(Math.max(...values))];
            const worstTopic = labels[values.indexOf(Math.min(...values))];
            document.getElementById('topicSummary').innerHTML = 
                `<strong>Analysis:</strong> ${bestTopic} is your strongest area (${Math.max(...values)}%) while ${worstTopic} needs attention (${Math.min(...values)}%). 
                Consider focusing more study time on ${worstTopic}.`;
        }
    }

    function createSubjectChart(subjectData) {
        const ctx = document.getElementById('subjectChart');
        if (!ctx) return;

        const data = subjectData || { Mathematics: 78, English: 85, Science: 80, History: 82 };
        const labels = Object.keys(data);
        const values = Object.values(data);

        if (studentCharts.subjectChart) studentCharts.subjectChart.destroy();
        
        studentCharts.subjectChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    data: values,
                    backgroundColor: [
                        'rgba(99,102,241,0.8)', 
                        'rgba(236,72,153,0.8)',
                        'rgba(16,185,129,0.8)',
                        'rgba(245,158,11,0.8)'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });

        // Update subject summary
        if (labels.length > 0) {
            const bestSubject = labels[values.indexOf(Math.max(...values))];
            document.getElementById('subjectSummary').innerHTML = 
                `<strong>Analysis:</strong> ${bestSubject} leads with ${Math.max(...values)}% average. 
                All subjects show positive growth trends this semester.`;
        }
    }

    function updateComparisonData(data) {
        const dayData = data.day_averages || {};
        const teacherData = data.teacher_averages || {};
        const topicData = data.topic_averages || {};
        const subjectData = data.subject_averages || {};

        // Update best day
        if (Object.keys(dayData).length > 0) {
            const bestDay = Object.entries(dayData).reduce((a, b) => a[1] > b[1] ? a : b);
            document.getElementById('bestDayValue').textContent = bestDay[0];
        }

        // Update best teacher
        if (Object.keys(teacherData).length > 0) {
            const bestTeacher = Object.entries(teacherData).reduce((a, b) => a[1] > b[1] ? a : b);
            document.getElementById('bestTeacherValue').textContent = bestTeacher[0];
        }

        // Update best topic
        if (Object.keys(topicData).length > 0) {
            const bestTopic = Object.entries(topicData).reduce((a, b) => a[1] > b[1] ? a : b);
            const worstTopic = Object.entries(topicData).reduce((a, b) => a[1] < b[1] ? a : b);
            
            document.getElementById('bestTopicValue').textContent = bestTopic[0];
            document.getElementById('weakTopicValue').textContent = worstTopic[0];
        }
    }

    function updateKPIs(data) {
        // Update overall average
        document.getElementById('overallAverage').textContent = data.overall_average + '%';
        document.getElementById('overallTrend').textContent = '+2% from last month';

        // Update subject scores
        const subjectData = data.subject_averages || {};
        document.getElementById('mathScore').textContent = (subjectData.Mathematics || 0) + '%';
        document.getElementById('englishScore').textContent = (subjectData.English || 0) + '%';
        
        document.getElementById('mathTrend').textContent = 'Consistent performance';
        document.getElementById('englishTrend').textContent = 'Strong improvement';

        // Update best performance
        if (Object.keys(subjectData).length > 0) {
            const bestSubject = Object.entries(subjectData).reduce((a, b) => a[1] > b[1] ? a : b);
            document.getElementById('bestScore').textContent = bestSubject[1] + '%';
            document.getElementById('bestSubject').textContent = 'In ' + bestSubject[0];
        }
    }

    function updateRecommendations(recommendations) {
        const container = document.getElementById('recommendations-container');
        container.innerHTML = '';

        if (recommendations.length === 0) {
            container.innerHTML = `
                <div class="recommendation-card">
                    <h4>NO DATA AVAILABLE</h4>
                    <p>Complete more assessments to get personalized recommendations.</p>
                </div>
            `;
            return;
        }

        recommendations.forEach(rec => {
            const card = document.createElement('div');
            card.className = 'recommendation-card';
            
            // Add specific styling based on recommendation type
            if (rec.type && rec.type.includes('improvement')) {
                card.classList.add('warning');
            } else if (rec.confidence === 'high') {
                card.classList.add('danger');
            }
            
            card.innerHTML = `
                <h4>${rec.type ? rec.type.replace(/_/g, ' ').toUpperCase() : 'RECOMMENDATION'}</h4>
                <p>${rec.text}</p>
                ${rec.impact_score ? `<div style="margin-top: 8px; font-size: 12px; color: var(--accent3);">Potential improvement: +${rec.impact_score}%</div>` : ''}
                ${rec.action ? `<div style="margin-top: 4px; font-size: 11px; color: var(--muted);">Action: ${rec.action}</div>` : ''}
            `;
            container.appendChild(card);
        });
    }

    function exportReport(reportType) {
        const url = `/api/export-report?type=${reportType}`;
        window.location.href = url;
    }

    function hideFlashMessages() {
        document.querySelectorAll('.flash-message').forEach(msg => {
            msg.style.display = 'none';
        });
    }
</script>
</body>
</html>
